<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Invoice Form - VendorInvoice Pro</title>
    <link rel="stylesheet" href="../static/main.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script type="module"
        src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fvendorinvo3864back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.5"></script>
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100">
    <!-- Header Navigation -->
    <header class="w-full bg-white shadow-subtle border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <!-- Logo and Brand -->
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-primary-800 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-slate-900">VendorInvoice Pro</h1>
                        <p class="text-sm text-slate-600 hidden sm:block">Invoice Management System</p>
                    </div>
                </div>

                <!-- Navigation Links -->
                <nav class="hidden md:flex items-center space-x-8">
                    <a href="/dashboard"
                        class="text-slate-600 hover:text-primary-800 transition-colors font-medium">
                        Dashboard
                    </a>
                    <a href="/invoice/invoices/manage"
                        class="text-slate-600 hover:text-primary-800 transition-colors font-medium">
                        Invoices
                    </a>
                    <a href="vendor_management.html"
                        class="text-slate-600 hover:text-primary-800 transition-colors font-medium">
                        Vendors
                    </a>
                </nav>

                <!-- User Profile & Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Mobile Menu Button -->
                    <button id="mobileMenuBtn"
                        class="md:hidden p-2 rounded-lg text-slate-600 hover:bg-slate-100 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>

                    <!-- User Profile -->
                    <div class="flex items-center space-x-3">
                        <div class="w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center">
                            <svg class="w-5 h-5 text-primary-800" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                            </svg>
                        </div>
                        <div class="hidden sm:block">
                            <p class="text-sm font-medium text-slate-900">Admin User</p>
                        </div>
                    </div>

                    <!-- Logout -->
                    <a href="/logout"
                        class="text-slate-600 hover:text-error-600 transition-colors p-2 rounded-lg hover:bg-slate-100">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                        </svg>
                    </a>
                </div>
            </div>
        </div>

        <!-- Mobile Navigation Menu -->
        <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-slate-200">
            <div class="px-4 py-3 space-y-2">
                <a href="dashboard_overview.html"
                    class="block px-3 py-2 text-slate-600 hover:text-primary-800 hover:bg-slate-50 rounded-lg transition-colors">
                    Dashboard
                </a>
                <a href="invoice_management.html"
                    class="block px-3 py-2 text-slate-600 hover:text-primary-800 hover:bg-slate-50 rounded-lg transition-colors">
                    Invoices
                </a>
                <a href="vendor_management.html"
                    class="block px-3 py-2 text-slate-600 hover:text-primary-800 hover:bg-slate-50 rounded-lg transition-colors">
                    Vendors
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Page Header -->
        <div class="mb-8">
            <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-slate-900 mb-2">Create Invoice</h1>
                    <p class="text-slate-600">Add a new invoice to your system with vendor and payment details</p>
                </div>
                <div class="mt-4 sm:mt-0">
                    <a href="invoice_management.html"
                        class="inline-flex items-center px-4 py-2 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                        </svg>
                        Back to Invoices
                    </a>
                </div>
            </div>
        </div>

        <!-- Form Container -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <!-- Main Form Section -->
            <div class="lg:col-span-8">
                <div class="bg-white rounded-xl shadow-elevated border border-slate-200 p-6 sm:p-8">
                   <form id="invoiceForm" class="space-y-6"
            method="POST"
            action="/invoice/create">

        <!-- Vendor Selection -->
        <div>
          <label for="vendor" class="block text-sm font-medium text-slate-700 mb-2">
            Select Vendor *
          </label>
          <select id="vendor"
                  name="vendor_id"
                  required
                  class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white">
            <option value="">Choose a vendor…</option>
            <option value="1">Acme Corporation</option>
            <option value="2">Tech Solutions Inc.</option>
            <option value="3">Global Supplies Ltd.</option>
            <option value="4">Creative Agency Co.</option>
            <option value="5">Logistics Pro Services</option>
          </select>
        </div>

        <!-- Invoice Month -->
        <div>
          <label for="month" class="block text-sm font-medium text-slate-700 mb-2">
            Invoice Month *
          </label>
          <input type="month"
                 id="month"
                 name="month"
                 required
                 class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" />
        </div>

        <!-- Invoice Number & Due Date -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <div>
            <label for="invoiceNumber" class="block text-sm font-medium text-slate-700 mb-2">
              Invoice Number *
            </label>
            <input type="text"
                   id="invoiceNumber"
                   name="invoiceNumber"
                   required
                   class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"
                   placeholder="INV-2025-001"
                   value="INV-2025-001" />
          </div>
          <div>
            <label for="dueDate" class="block text-sm font-medium text-slate-700 mb-2">
              Due Date *
            </label>
            <input type="date"
                   id="dueDate"
                   name="dueDate"
                   required
                   class="w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500" />
          </div>
        </div>

        <!-- Form Actions -->
        <div class="flex justify-end space-x-3 pt-6 border-t border-slate-200">
          <a href="/invoice" 
             class="inline-flex items-center px-6 py-3 text-sm font-medium text-slate-600 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors">
            Cancel
          </a>
          <button type="submit"
                  class="inline-flex items-center px-6 py-3 text-sm font-medium text-white bg-primary-800 rounded-lg hover:bg-primary-700 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all duration-200 hover:shadow-md">
            Save Invoice
          </button>
        </div>

      </form>
                </div>
            </div>

            <!-- Summary Panel -->
            <div class="lg:col-span-4">
                <div class="bg-white rounded-xl shadow-elevated border border-slate-200 p-6 sticky top-24">
                    <!-- Invoice Summary -->
                    <div class="mb-6">
                        <h3 class="text-lg font-semibold text-slate-900 mb-4">Invoice Summary</h3>

                        <!-- Summary Details -->
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-slate-600">Subtotal:</span>
                                <span id="subtotalAmount" class="text-sm font-medium text-slate-900">$0.00</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-slate-600">Tax (0%):</span>
                                <span id="taxAmount" class="text-sm font-medium text-slate-900">$0.00</span>
                            </div>
                            <div class="border-t border-slate-200 pt-3">
                                <div class="flex justify-between items-center">
                                    <span class="text-base font-semibold text-slate-900">Total:</span>
                                    <span id="totalAmount" class="text-base font-bold text-primary-800">$0.00</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Status Preview -->
                    <div class="mb-6">
                        <h4 class="text-sm font-medium text-slate-700 mb-2">Status Preview</h4>
                        <div id="statusPreview"
                            class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-slate-100 text-slate-600">
                            Draft
                        </div>
                    </div>

                    <!-- Form Progress -->
                    <div class="mb-6">
                        <h4 class="text-sm font-medium text-slate-700 mb-3">Form Progress</h4>
                        <div class="space-y-2">
                            <div class="flex items-center">
                                <div id="vendorCheck"
                                    class="w-4 h-4 rounded-full bg-slate-200 mr-3 flex items-center justify-center">
                                    <svg class="w-2.5 h-2.5 text-white hidden" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                            clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <span class="text-sm text-slate-600">Vendor Selected</span>
                            </div>
                            <div class="flex items-center">
                                <div id="amountCheck"
                                    class="w-4 h-4 rounded-full bg-slate-200 mr-3 flex items-center justify-center">
                                    <svg class="w-2.5 h-2.5 text-white hidden" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                            clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <span class="text-sm text-slate-600">Amount Entered</span>
                            </div>
                            <div class="flex items-center">
                                <div id="dateCheck"
                                    class="w-4 h-4 rounded-full bg-slate-200 mr-3 flex items-center justify-center">
                                    <svg class="w-2.5 h-2.5 text-white hidden" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd"
                                            d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                                            clip-rule="evenodd" />
                                    </svg>
                                </div>
                                <span class="text-sm text-slate-600">Due Date Set</span>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="border-t border-slate-200 pt-6">
                        <h4 class="text-sm font-medium text-slate-700 mb-3">Quick Actions</h4>
                        <div class="space-y-2">
                            <button type="button" onclick="previewInvoice()"
                                class="w-full flex items-center justify-center px-3 py-2 text-sm font-medium text-slate-600 bg-slate-50 border border-slate-200 rounded-lg hover:bg-slate-100 transition-colors">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                </svg>
                                Preview Invoice
                            </button>
                            <a href="vendor_form.html"
                                class="w-full flex items-center justify-center px-3 py-2 text-sm font-medium text-slate-600 bg-slate-50 border border-slate-200 rounded-lg hover:bg-slate-100 transition-colors">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                </svg>
                                Add New Vendor
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="w-full py-8 px-4 sm:px-6 lg:px-8 bg-white border-t border-slate-200 mt-16">
        <div class="max-w-7xl mx-auto">
            <div class="flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0">
                <div class="flex items-center space-x-6">
                    <!-- SSL Badge -->
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-accent-600 rounded-full flex items-center justify-center">
                            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs font-medium text-slate-700">SSL Secured</p>
                            <p class="text-xs text-slate-500">256-bit Encryption</p>
                        </div>
                    </div>

                    <!-- Business Certified -->
                    <div class="flex items-center space-x-2">
                        <div class="w-8 h-8 bg-primary-800 rounded-full flex items-center justify-center">
                            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-xs font-medium text-slate-700">Business Certified</p>
                            <p class="text-xs text-slate-500">SOC 2 Type II</p>
                        </div>
                    </div>
                </div>

                <!-- Footer Links -->
                <div class="flex items-center space-x-6 text-xs text-slate-500">
                    <a href="#" class="hover:text-slate-700 transition-colors">Privacy Policy</a>
                    <a href="#" class="hover:text-slate-700 transition-colors">Terms of Service</a>
                    <a href="#" class="hover:text-slate-700 transition-colors">Support</a>
                </div>
            </div>

            <!-- Copyright -->
            <div class="mt-6 pt-6 border-t border-slate-200 text-center">
                <p class="text-xs text-slate-500">
                    © 2025 VendorInvoice Pro. All Rights Reserved. | Secure Invoice Management for Business
                </p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Mobile menu toggle
        document.getElementById('mobileMenuBtn').addEventListener('click', function () {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        });

        // Set default due date (30 days from today)
        document.addEventListener('DOMContentLoaded', function () {
            const today = new Date();
            const dueDate = new Date(today.getTime() + (30 * 24 * 60 * 60 * 1000));
            document.getElementById('dueDate').value = dueDate.toISOString().split('T')[0];

            // Add event listeners for form progress
            document.getElementById('vendor').addEventListener('change', updateProgress);
            document.getElementById('amount').addEventListener('input', updateProgress);
            document.getElementById('dueDate').addEventListener('change', updateProgress);

            updateProgress();
        });

        // Generate invoice number
        function generateInvoiceNumber() {
            const today = new Date();
            const year = today.getFullYear();
            const month = String(today.getMonth() + 1).padStart(2, '0');
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            const invoiceNumber = `INV-${year}-${month}-${random}`;
            document.getElementById('invoiceNumber').value = invoiceNumber;
        }

        // Update summary panel
        function updateSummary() {
            const amount = parseFloat(document.getElementById('amount').value) || 0;
            const status = document.getElementById('status').value;

            // Update amounts
            document.getElementById('subtotalAmount').textContent = `$${amount.toFixed(2)}`;
            document.getElementById('taxAmount').textContent = '$0.00';
            document.getElementById('totalAmount').textContent = `$${amount.toFixed(2)}`;

            // Update status preview
            const statusPreview = document.getElementById('statusPreview');
            statusPreview.textContent = status.charAt(0).toUpperCase() + status.slice(1);

            // Update status styling
            statusPreview.className = 'inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ';
            switch (status) {
                case 'paid':
                    statusPreview.className += 'bg-success-100 text-success-600';
                    break;
                case 'pending':
                    statusPreview.className += 'bg-warning-100 text-warning-600';
                    break;
                case 'overdue':
                    statusPreview.className += 'bg-error-100 text-error-600';
                    break;
                default:
                    statusPreview.className += 'bg-slate-100 text-slate-600';
            }
        }

        // Update form progress
        function updateProgress() {
            const vendor = document.getElementById('vendor').value;
            const amount = document.getElementById('amount').value;
            const dueDate = document.getElementById('dueDate').value;

            updateProgressItem('vendorCheck', vendor);
            updateProgressItem('amountCheck', amount);
            updateProgressItem('dateCheck', dueDate);
        }

        function updateProgressItem(checkId, value) {
            const checkElement = document.getElementById(checkId);
            const icon = checkElement.querySelector('svg');

            if (value) {
                checkElement.className = 'w-4 h-4 rounded-full bg-success-500 mr-3 flex items-center justify-center';
                icon.classList.remove('hidden');
            } else {
                checkElement.className = 'w-4 h-4 rounded-full bg-slate-200 mr-3 flex items-center justify-center';
                icon.classList.add('hidden');
            }
        }

        // Form validation
        function validateForm() {
            let isValid = true;

            // Clear previous errors
            document.querySelectorAll('[id$="Error"]').forEach(el => el.classList.add('hidden'));

            // Validate vendor
            const vendor = document.getElementById('vendor').value;
            if (!vendor) {
                showError('vendorError', 'Please select a vendor');
                isValid = false;
            }

            // Validate invoice number
            const invoiceNumber = document.getElementById('invoiceNumber').value;
            if (!invoiceNumber.trim()) {
                showError('invoiceNumberError', 'Invoice number is required');
                isValid = false;
            }

            // Validate amount
            const amount = parseFloat(document.getElementById('amount').value);
            if (!amount || amount <= 0) {
                showError('amountError', 'Please enter a valid amount greater than 0');
                isValid = false;
            }

            // Validate due date
            const dueDate = document.getElementById('dueDate').value;
            if (!dueDate) {
                showError('dueDateError', 'Due date is required');
                isValid = false;
            }

            return isValid;
        }

        function showError(elementId, message) {
            const errorElement = document.getElementById(elementId);
            errorElement.textContent = message;
            errorElement.classList.remove('hidden');
        }

        // Handle form submission
        function handleSubmit(event) {
            event.preventDefault();

            if (!validateForm()) {
                return;
            }

            // Show loading state
            const submitBtn = event.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = `
                <svg class="animate-spin -ml-1 mr-3 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Saving...
            `;
            submitBtn.disabled = true;

            // Simulate API call
            setTimeout(() => {
                alert('Invoice saved successfully!');
                window.location.href = 'invoice_management.html';
            }, 1500);
        }

        // Save and create new
        function saveAndNew() {
            if (!validateForm()) {
                return;
            }

            alert('Invoice saved! Creating new invoice...');
            // Reset form
            document.getElementById('invoiceForm').reset();
            generateInvoiceNumber();
            updateSummary();
            updateProgress();
        }

        // Preview invoice
        function previewInvoice() {
            if (!validateForm()) {
                alert('Please complete all required fields before previewing.');
                return;
            }

            alert('Invoice preview would open here (feature coming soon)');
        }

        // Warn about unsaved changes
        let formChanged = false;
        document.getElementById('invoiceForm').addEventListener('input', function () {
            formChanged = true;
        });

        window.addEventListener('beforeunload', function (e) {
            if (formChanged) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            fetch('/invoice/vendors')
                .then(r => r.json())
                .then(vendors => {
                    const sel = document.getElementById('vendor');
                    sel.innerHTML = '<option value="">-- Select vendor --</option>';
                    vendors.forEach(v => {
                        const o = document.createElement('option');
                        o.value = v.id;
                        o.textContent = v.name;
                        sel.appendChild(o);
                    });
                })
                .catch(err => {
                    console.error('Failed to load vendors', err);
                    document.getElementById('vendor').innerHTML = '<option>Error loading vendors</option>';
                });
        });
    </script>

</body>

</html>